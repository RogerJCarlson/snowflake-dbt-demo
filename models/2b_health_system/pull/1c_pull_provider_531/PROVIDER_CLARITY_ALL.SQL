SELECT DISTINCT CLARITY_SER.PROV_ID 

, CLARITY_SER.PROV_NAME 
, TRY_TO_NUMBER (CLARITY_SER.PROV_ID, '9999999999' ,38,0) AS TRYTONUMBER
, CLARITY_SER_2.NPI AS NPI
, DEA_NUMBER AS DEA
, ZC_SPECIALTY.SPECIALTY_C
, ZC_SPECIALTY.NAME AS ZC_SPECIALTY_NAME
, REV_LOC_ID    
, BIRTH_DATE
, CLARITY_SER.PROV_TYPE
, CLARITY_SER.SEX_C    
, ZC_SEX.NAME AS ZC_SEX_NAME 


FROM {{ source('CLARITY','CLARITY_SER')}} AS CLARITY_SER

    LEFT JOIN {{ source('CLARITY','CLARITY_EMP')}} AS CLARITY_EMP
        ON CLARITY_SER.PROV_ID = CLARITY_EMP.PROV_ID
        
    LEFT JOIN {{ source('CLARITY','CLARITY_DEP')}} AS CLARITY_DEP
        ON CLARITY_EMP.LGIN_DEPARTMENT_ID = CLARITY_DEP.DEPARTMENT_ID
        
    LEFT JOIN {{ source('CLARITY','ZC_SEX')}} AS ZC_SEX
        ON ZC_SEX.RCPT_MEM_SEX_C = CLARITY_SER.SEX_C
  
    LEFT JOIN {{ source('CLARITY','CLARITY_SER_2')}} AS CLARITY_SER_2
        ON CLARITY_SER.PROV_ID = CLARITY_SER_2.PROV_ID

    LEFT OUTER JOIN {{ source('CLARITY','D_PROV_PRIMARY_HIERARCHY')}} AS D_PROV_PRIMARY_HIERARCHY
        ON CLARITY_SER.PROV_ID = D_PROV_PRIMARY_HIERARCHY.PROV_ID
        
    LEFT OUTER JOIN {{ source('CLARITY','ZC_SPECIALTY')}} AS ZC_SPECIALTY
            ON D_PROV_PRIMARY_HIERARCHY.SPECIALTY_C = ZC_SPECIALTY.SPECIALTY_C
            
 
where   UPPER(CLARITY_SER.PROV_TYPE) not in('RESOURCE','LABORATORY')
AND TRY_TO_NUMBER (CLARITY_SER.PROV_ID, '9999999999',38,0) IS NOT NULL 
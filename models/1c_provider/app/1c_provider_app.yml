version: 2

models:
  - name: PROVIDER
    description: The PROVIDER table contains a list of uniquely identified healthcare providers. These are individuals providing hands-on healthcare to patients, such as physicians, nurses, midwives, physical therapists etc.
    columns: 
      - name: PROVIDER_ID
        tests:
          - unique
          - not_null

      - name: CARE_SITE_ID
        tests:
          - relationships:
              to: ref('CARE_SITE')
              field: CARE_SITE_ID 
              severity: warn

      - name: GENDER_CONCEPT_ID
        tests:
          - not_null
          - relationships:
              to: source('CDM','CONCEPT')
              field: CONCEPT_ID   

      - name: GENDER_SOURCE_CONCEPT_ID
        description: Not Applicable - Value:0      
        tests:
          - accepted_values:
              values:
                - 0

      - name: SPECIALTY_CONCEPT_ID
        tests:
          - not_null
          - relationships:
              to: source('CDM','CONCEPT')
              field: CONCEPT_ID 

      - name: SPECIALTY_SOURCE_CONCEPT_ID
        description: Not Applicable - Value:0
        tests:
          - accepted_values:
              values:
                - 0
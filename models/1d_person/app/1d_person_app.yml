version: 2

models:
  - name: PERSON
    description: This table serves as the central identity management for all Persons in the database. It contains records that uniquely identify each person or patient, and some demographic information.
    columns: 
      - name: PERSON_ID
        tests:
          - unique
          - not_null

      - name: CARE_SITE_ID
        tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              to: ref('CARE_SITE')
              field: CARE_SITE_ID

      - name: ETHNICITY_CONCEPT_ID
        tests:
          - not_null
          - relationships:
              to: source('CDM','CONCEPT')
              field: CONCEPT_ID 

      - name: ETHNICITY_SOURCE_CONCEPT_ID
        description: Not Applicable - Value:0      
        tests:
          - accepted_values:
              values:
                - 0

      - name: GENDER_CONCEPT_ID
        tests:
          - not_null
          - relationships:
              to: source('CDM','CONCEPT')
              field: CONCEPT_ID 

      - name: GENDER_SOURCE_CONCEPT_ID
        description: Not Applicable - Value:0      
        tests:
          - accepted_values:
              values:
                - 0

      - name: LOCATION_ID
        tests:
          - not_null
          - relationships:
              to: ref('LOCATION')
              field: LOCATION_ID 

      - name: PROVIDER_ID
        tests:
          - not_null:
              config:
                severity: warn
          - relationships:
              to: ref('PROVIDER')
              field: PROVIDER_ID
           
      - name: RACE_CONCEPT_ID
        tests:
          - not_null
          - relationships:
              to: source('CDM','CONCEPT')
              field: CONCEPT_ID 
 
      - name: RACE_SOURCE_CONCEPT_ID
        description: Not Applicable - Value:0      
        tests:
          - accepted_values:
              values:
                - 0
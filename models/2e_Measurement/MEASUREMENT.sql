--MEASUREMENT 

{{ config(materialized = 'table') }} 

SELECT 
    SEQ_MEASUREMENT.NEXTVAL::NUMBER(28,0)           AS MEASUREMENT_ID 
    , PERSON_ID::NUMBER(28,0)                       AS PERSON_ID 
    , MEASUREMENT_CONCEPT_ID::NUMBER(28,0)          AS MEASUREMENT_CONCEPT_ID 
    , MEASUREMENT_DATE::DATE                        AS MEASUREMENT_DATE
    , MEASUREMENT_DATETIME::DATETIME                AS MEASUREMENT_DATETIME
    , NULL::VARCHAR(50)                             AS MEASUREMENT_TIME
    , MEASUREMENT_TYPE_CONCEPT_ID::NUMBER(28,0)     AS MEASUREMENT_TYPE_CONCEPT_ID 
    , OPERATOR_CONCEPT_ID::NUMBER(28,0)             AS OPERATOR_CONCEPT_ID 
    , VALUE_AS_NUMBER::FLOAT                        AS VALUE_AS_NUMBER
    , VALUE_AS_CONCEPT_ID::NUMBER(28,0)             AS VALUE_AS_CONCEPT_ID 
    , UNIT_CONCEPT_ID::NUMBER(28,0)                 AS UNIT_CONCEPT_ID 
    , RANGE_LOW::FLOAT                              AS RANGE_LOW
    , RANGE_HIGH::FLOAT                             AS RANGE_HIGH
    , PROVIDER_ID::NUMBER(28,0)                     AS PROVIDER_ID
    , VISIT_OCCURRENCE_ID::NUMBER(28,0)             AS VISIT_OCCURRENCE_ID 
    , VISIT_DETAIL_ID::NUMBER(28,0)                 AS VISIT_DETAIL_ID 
    , MEASUREMENT_SOURCE_VALUE::VARCHAR(50)         AS MEASUREMENT_SOURCE_VALUE
    , MEASUREMENT_SOURCE_CONCEPT_ID::NUMBER(28,0)   AS MEASUREMENT_SOURCE_CONCEPT_ID 
    , UNIT_SOURCE_VALUE::VARCHAR(50)                AS UNIT_SOURCE_VALUE
    , VALUE_SOURCE_VALUE::VARCHAR(50)               AS VALUE_SOURCE_VALUE
    , ETL_MODULE::VARCHAR(50)                       AS ETL_MODULE
    , VISIT_SOURCE_VALUE::VARCHAR(50)               AS VISIT_SOURCE_VALUE
FROM
(   --HSP
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_HSP_BMI')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_HSP_BPD')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_HSP_BPS')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_HSP_MISC')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_HSP_TEMPERATURE')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_HSP_VITALS')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_LOINC_HSP')}}

    --AMB
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_AMB_BMI')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_AMB_BPD')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_AMB_BPS')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_AMB_MISC')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_AMB_TEMPERATURE')}}  
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_AMB_VITALS')}}
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_LOINC_AMB')}}

    --ANES
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_ANES_BPD')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_ANES_BPM')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_ANES_BPS')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_ANES_MISC')}} 
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_ANES_TEMPERATURE')}}
    UNION ALL
    SELECT * FROM {{ref('V_MEASUREMENT_FLOWSHEET_ANES_VITALS')}}        
) AS A
